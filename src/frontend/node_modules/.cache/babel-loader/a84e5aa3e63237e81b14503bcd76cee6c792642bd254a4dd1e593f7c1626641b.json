{"ast":null,"code":"import { computed, onMounted, ref } from 'vue';\nimport services from '../../services/services.js';\nimport { useStore } from 'vuex';\nimport env from '../../../env.js';\nexport default {\n  setup() {\n    const store = useStore();\n    const books = ref([]);\n    const loading = ref(true);\n    const user = computed(() => store.state.user);\n    const getRecomendations = async () => {\n      loading.value = true;\n      try {\n        const bmks = await services.getBookmarks(1, 15, user.value._id);\n        const lkG = await services.getGenres(user.value._id);\n        const bmk = bmks.data.books.map(book => `${book.title} - ${book.author}`);\n        const genres = lkG.data.genres;\n        const response = await services.getRecomended({\n          bookmarks: bmk,\n          likedGenres: genres\n        });\n        const data = response.data;\n        books.value = data.recommendedBooks;\n        for (let i = 0; i < books.value.length; i++) {\n          const googleBooksUrl = `https://www.googleapis.com/books/v1/volumes?q=intitle:${encodeURIComponent(books.value[i].title)}+inauthor:${encodeURIComponent(books.value[i].author)}&key=${env.googleApiKey}`;\n          const res = await fetch(googleBooksUrl);\n          const data = await res.json();\n          if (data.items && data.items.length > 0) {\n            books.value[i].picture_link = data.items[0].volumeInfo.imageLinks ? data.items[0].volumeInfo.imageLinks.thumbnail : '';\n            books.value[i].page_count = data.items[0].volumeInfo.pageCount || 'N/A';\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching books:', error);\n      } finally {\n        loading.value = false;\n      }\n    };\n    onMounted(() => {\n      getRecomendations();\n    });\n    return {\n      books,\n      loading\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","ref","services","useStore","env","setup","store","books","loading","user","state","getRecomendations","value","bmks","getBookmarks","_id","lkG","getGenres","bmk","data","map","book","title","author","genres","response","getRecomended","bookmarks","likedGenres","recommendedBooks","i","length","googleBooksUrl","encodeURIComponent","googleApiKey","res","fetch","json","items","picture_link","volumeInfo","imageLinks","thumbnail","page_count","pageCount","error","console"],"sources":["C:\\Users\\mynig\\VScodium\\Book-Recommender\\frontend\\src\\views\\RecomendedBooksView.vue"],"sourcesContent":["<template>\r\n    <div class=\"container py-5\">\r\n        <div v-if=\"loading\" class=\"spinner\">Loading...</div>\r\n        <div class=\"row row-cols-1 row-cols-md-3 g-4 py-5\" v-else>\r\n            <div class=\"col\" v-for=\"item in books\" :key=\"item._id\">\r\n                <div class=\"card\">\r\n                    <div class=\"card-img\">\r\n                      <img :src=\"item.picture_link\" class=\"card-img-top\" alt=\"...\">\r\n                    </div>\r\n                    <div class=\"card-body\">\r\n                        <h5 class=\"card-title\">{{ item.title }}</h5>\r\n                        <p class=\"card-text\">{{ item.description }}</p>\r\n                    </div>\r\n                    <div class=\"mb-5 justify-content-around\">\r\n                      <div>\r\n                        <h4><i class=\"lni lni-pencil\"></i>{{ item.author }}</h4>\r\n                      </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {  computed, onMounted, ref } from 'vue';\r\nimport services from '../../services/services.js';\r\nimport { useStore } from 'vuex';\r\nimport env from '../../../env.js'\r\n\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const books = ref([]);\r\n    const loading = ref(true);\r\n    const user = computed(() => store.state.user);\r\n\r\n    const getRecomendations = async () => {\r\n        loading.value = true;\r\n\r\n        try {\r\n            const bmks = await services.getBookmarks(1, 15, user.value._id);\r\n            const lkG = await services.getGenres(user.value._id);\r\n\r\n            const bmk = bmks.data.books.map(book => `${book.title} - ${book.author}`);\r\n        \r\n            const genres = lkG.data.genres;\r\n\r\n            const response = await services.getRecomended({\r\n                bookmarks: bmk,\r\n                likedGenres: genres\r\n            });\r\n            const data = response.data;\r\n            books.value = data.recommendedBooks;\r\n            for(let i = 0; i < books.value.length; i++){\r\n                const googleBooksUrl = `https://www.googleapis.com/books/v1/volumes?q=intitle:${encodeURIComponent(books.value[i].title)}+inauthor:${encodeURIComponent(books.value[i].author)}&key=${env.googleApiKey}`;\r\n                const res = await fetch(googleBooksUrl);\r\n                const data = await res.json();\r\n\r\n                if (data.items && data.items.length > 0) {\r\n                    books.value[i].picture_link = data.items[0].volumeInfo.imageLinks ? data.items[0].volumeInfo.imageLinks.thumbnail : '';\r\n                    books.value[i].page_count = data.items[0].volumeInfo.pageCount || 'N/A';\r\n                }\r\n\r\n            }\r\n            \r\n        } catch(error){\r\n            console.error('Error fetching books:', error);\r\n        } finally {\r\n            loading.value = false;\r\n        }\r\n    };\r\n    \r\n\r\n    onMounted(() => {\r\n        getRecomendations()\r\n    });\r\n\r\n    return {\r\n      books,\r\n      loading,\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style  scoped lang=\"scss\">\r\n  *{\r\n    padding: 0;\r\n    margin: 0;\r\n    box-sizing: border-box;\r\n}\r\n.card-img-top{\r\n    border-radius: 50px;\r\n    height: 300px;\r\n    width: 300px; \r\n    padding: 20px;\r\n}\r\n.card-img{\r\n  align-items: center;\r\n}\r\n.card{\r\n    border-radius: 30px;\r\n    box-shadow: rgba(0, 0, 0, 0.1) 0px 1px 2px 0px;\r\n}\r\n.card-text {\r\n  max-height: 200px;  \r\n}\r\n.card-body{\r\n    padding: 25px;\r\n    margin-top: -15px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}